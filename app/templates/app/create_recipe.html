{% extends 'app/base.html' %}
{% load bootstrap5 %}

{% block scripts %}<script>
    function addIngredient() {
        ingredients = document.getElementById('ingredients');
        ingredient_count = document.getElementById('ingredient_count');
        new_ingredient = ingredients.lastElementChild.cloneNode(deep=true);
        new_ingredient.children[0].children[0].children[0].id = `ingredient${ingredient_count.value}`
        new_ingredient.children[0].children[1].children[0].id = `quantity${ingredient_count.value}`
        new_ingredient.children[0].children[2].children[0].id = `units${ingredient_count.value}`
        for (let i = 0; i < 3; i++) {
            console.log(new_ingredient.children[0].children[i].children[0])
        }
        ingredients.appendChild(new_ingredient)
        ingredient_count.value = parseInt(ingredient_count.value) + 1;
    }
</script>{% endblock scripts %}

{% block boostrap5_title %}A-05 Project Recipe Creation{% endblock boostrap5_title %}

{% block content %}
    {% if user.is_authenticated %}
        <form action="{% url 'app:submit_recipe' %}" method="post" enctype="multipart/form-data">
            {% csrf_token %}
            <fieldset>
                <label for='recipe_name' class='form-label'>Recipe Title:</label>
                <input id='recipe_name' name="recipe_name" type='text' class='form-control' required><br>

                <label for='recipe_time' class='form-label'>Time to Cook:</label>
                <input id='recipe_time' name="recipe_time" type='text' class='form-control' required><br>
            
                <label for='recipe_description' class='form-label'>Recipe Description:</label>
                <textarea id='recipe_description' name="recipe_description" class='form-control' required></textarea><br>
            
                <!-- <label for='recipe_ingredients' class='form-label'>Recipe Ingredients:</label>
                <textarea id='recipe_ingredients' name="recipe_ingredients" class='form-control' required></textarea><br> -->
                <label for='ingredients' class='form-label'>Ingredients List</label>
                <section id='ingredients'>
                    <div><div class='row'>
                        <div class='col'><input id='ingredient0' type='text' class='form-control' required></div>
                        <div class='col'><input id='quantity0' type='number' class='form-control' required></div>
                        <div class='col'><input id='units0' type='text' class='form-control' required></div>
                    </div><br></div>
                    <div><div class='row'>
                        <div class='col'><input id='ingredient1' type='text' class='form-control' required></div>
                        <div class='col'><input id='quantity1' type='number' class='form-control' required></div>
                        <div class='col'><input id='units1' type='text' class='form-control' required></div>
                    </div><br></div>
                    <div><div class='row'>
                        <div class='col'><input id='ingredient2' type='text' class='form-control' required></div>
                        <div class='col'><input id='quantity2' type='number' class='form-control' required></div>
                        <div class='col'><input id='units2' type='text' class='form-control' required></div>
                    </div><br></div>
                </section>
                <input id='ingredient_count' type="hidden" value=3>
                <button id='add_ingredient' name='add_ingredient' type='button' class='btn btn-primary' onclick='addIngredient()'>Add Ingredient</button><br>

                <label for='recipe_steps' class='form-label'>Recipe Instructions:</label>
                <textarea id='recipe_steps' name="recipe_steps" class='form-control' required></textarea><br>

                <label for='recipe_image'> Choose Picture (optional): </label>
                <input type="file" id='recipe_image' name="recipe_image" accept=".jpg, .jpeg, .png"> 
                
                <input type="submit" value="Post" class='btn btn-primary'>
            </fieldset>
        </form>
    {% else %}
        <p>Please sign in first to post a recipe</p>
    {% endif %}
{% endblock content %}
